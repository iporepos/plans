
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>plans.geo &#8212; plans 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/plans.geo';</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="plans.project" href="plans.project.html" />
    <link rel="prev" title="plans.analyst" href="plans.analyst.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="https://github.com/iporepos/plans-assets/blob/main/docs/figs/logo.jpg?raw=true" class="logo__image only-light" alt=""/>
    <img src="https://github.com/iporepos/plans-assets/blob/main/docs/figs/logo.jpg?raw=true" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">plans</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    Home
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../development.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/iporepos/plans" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    Home
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../development.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/iporepos/plans" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">API</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">plans.geo</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-plans.geo">
<span id="plans-geo"></span><h1>plans.geo<a class="headerlink" href="#module-plans.geo" title="Link to this heading">#</a></h1>
<p>Standalone geoprocessing routines with minimal dependencies.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p># todo [docstring] – overview
Mauris gravida ex quam, in porttitor lacus lobortis vitae.
In a lacinia nisl. Pellentesque habitant morbi tristique senectus
et netus et malesuada fames ac turpis egestas.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h2>
<p># todo [docstring] – examples
Lorem ipsum dolor sit amet, consectetur adipiscing elit.
Nulla mollis tincidunt erat eget iaculis. Mauris gravida ex quam,
in porttitor lacus lobortis vitae. In a lacinia nisl.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Mauris gravida ex quam, in porttitor lacus lobortis vitae.
In a lacinia nisl. Mauris gravida ex quam, in porttitor lacus lobortis vitae.
In a lacinia nisl.</p>
</section>
<p class="rubric">Functions</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.buffer" title="plans.geo.buffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffer</span></code></a>(grd_input, n_radius)</p></td>
<td><p>Calculate a buffer mask</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.carve_dem" title="plans.geo.carve_dem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">carve_dem</span></code></a>(grd_dem, grd_rivers[, ...])</p></td>
<td><p>Burn a <code class="docutils literal notranslate"><span class="pre">DEM</span></code> map with river lines.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.classify" title="plans.geo.classify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">classify</span></code></a>(array, upvalues, classes)</p></td>
<td><p>Classify array based on list of upper values and list of classes values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.convert" title="plans.geo.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a>(array, old_values, new_values)</p></td>
<td><p>Convert values in array from old to new values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.distance_to_outlet" title="plans.geo.distance_to_outlet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distance_to_outlet</span></code></a>(grd_ldd[, n_res, ...])</p></td>
<td><p>Compute the distance to outlet <code class="docutils literal notranslate"><span class="pre">DTO</span></code> raster of a given basin.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.downscale_linear" title="plans.geo.downscale_linear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downscale_linear</span></code></a>(scalar, array_covar[, mode])</p></td>
<td><p>Applies linear downscaling to a covariance array based on a scalar value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.downscale_variance" title="plans.geo.downscale_variance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downscale_variance</span></code></a>(mean, array_covar, ...[, ...])</p></td>
<td><p>Applies a downscaling operation to a mean array based on a covariance array and a scaling factor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.downscaling_mask" title="plans.geo.downscaling_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downscaling_mask</span></code></a>(array_covar, scale)</p></td>
<td><p>Compute a downscaling mask by using a covariate array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.downstream_coordinates" title="plans.geo.downstream_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downstream_coordinates</span></code></a>(n_dir, i, j[, ...])</p></td>
<td><p>Compute i and j downstream cell coordinates based on cell flow direction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.euclidean_distance" title="plans.geo.euclidean_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">euclidean_distance</span></code></a>(grd_input)</p></td>
<td><p>Calculate the Euclidean distance from pixels with value 1.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.extents_to_wkt_box" title="plans.geo.extents_to_wkt_box"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extents_to_wkt_box</span></code></a>(xmin, ymin, xmax, ymax)</p></td>
<td><p>Returns a WKT box from the given extents (xmin, ymin, xmax, ymax).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.fuzzify" title="plans.geo.fuzzify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fuzzify</span></code></a>(array[, min_value, max_value])</p></td>
<td><p>Fuzzify array between min and max values with linear membership function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.get_array_bbox" title="plans.geo.get_array_bbox"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_array_bbox</span></code></a>(array)</p></td>
<td><p>Finds the bounding box for the content (1s) in a 2D pseudo-boolean array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.get_basins_by_gauges" title="plans.geo.get_basins_by_gauges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_basins_by_gauges</span></code></a>(basins, gauges, ...[, ...])</p></td>
<td><p>Retrieve a list of upstream basins for a list of gauges.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.get_upstream_features" title="plans.geo.get_upstream_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_upstream_features</span></code></a>(features, field_id, ...)</p></td>
<td><p>Retrieves all upstream features from a given starting point.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.normalize" title="plans.geo.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>(array[, min_value, max_value])</p></td>
<td><p>Normalize array between min and max values</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.prune" title="plans.geo.prune"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prune</span></code></a>(array[, min_value, max_value])</p></td>
<td><p>Inclusive prune values in array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.rivers_wedge" title="plans.geo.rivers_wedge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rivers_wedge</span></code></a>(grd_rivers[, wedge_width, ...])</p></td>
<td><p>Generate a wedge-like trench along the river lines.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.shalstab_wetness" title="plans.geo.shalstab_wetness"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shalstab_wetness</span></code></a>(flowacc, slope, cellsize, ...)</p></td>
<td><p>Calculate the SHALSTAB wetness model</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.slope" title="plans.geo.slope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slope</span></code></a>(dem, cellsize[, degree])</p></td>
<td><p>Calculate slope using gradient-based algorithms on a 2D numpy array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.soils" title="plans.geo.soils"><code class="xref py py-obj docutils literal notranslate"><span class="pre">soils</span></code></a>(slope, hand[, slope_threshold, ...])</p></td>
<td><p>Calculates a basic soil classification grid based on slope and HAND (Height Above Nearest Drainage) data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.twi" title="plans.geo.twi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">twi</span></code></a>(slope, flowacc, cellsize)</p></td>
<td><p>Calculate the Topographic Wetness Index <code class="docutils literal notranslate"><span class="pre">TWI</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.upscale" title="plans.geo.upscale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upscale</span></code></a>(array[, weights, mode])</p></td>
<td><p>Upscales an array using a specified mode.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.usle_l" title="plans.geo.usle_l"><code class="xref py py-obj docutils literal notranslate"><span class="pre">usle_l</span></code></a>(slope, cellsize)</p></td>
<td><p>Wischmeier &amp; Smith (1978) L factor</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plans.geo.usle_m_a" title="plans.geo.usle_m_a"><code class="xref py py-obj docutils literal notranslate"><span class="pre">usle_m_a</span></code></a>(q, prec, r, k, l, s, c, p[, cellsize])</p></td>
<td><p>USLE-M Annual Soil Loss (Kinnell &amp; Risse, 1998)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plans.geo.usle_s" title="plans.geo.usle_s"><code class="xref py py-obj docutils literal notranslate"><span class="pre">usle_s</span></code></a>(slope)</p></td>
<td><p>Calculates the USLE S-factor (slope steepness factor) based on the Wischmeier &amp; Smith (1978) equation.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.extents_to_wkt_box">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">extents_to_wkt_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#extents_to_wkt_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.extents_to_wkt_box" title="Link to this definition">#</a></dt>
<dd><p>Returns a WKT box from the given extents (xmin, ymin, xmax, ymax).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmin</strong> (<em>float</em>) – Minimum x-coordinate (left)</p></li>
<li><p><strong>ymin</strong> – Minimum y-coordinate (bottom)</p></li>
<li><p><strong>xmax</strong> (<em>float</em>) – Maximum x-coordinate (right)</p></li>
<li><p><strong>ymax</strong> (<em>float</em>) – Maximum y-coordinate (top)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string representing the box in WKT format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.get_basins_by_gauges">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">get_basins_by_gauges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_gauge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_basin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_basin_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geometry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dissolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#get_basins_by_gauges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.get_basins_by_gauges" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of upstream basins for a list of gauges. This function identifies the basins in which each gauge
is located and then finds all upstream basins for each of these basins.
The resulting GeoDataFrame can optionally be dissolved into a single feature for each gauge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basins</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>) – A GeoDataFrame containing the basin features.</p></li>
<li><p><strong>gauges</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>) – A GeoDataFrame containing the gauge locations.</p></li>
<li><p><strong>field_gauge</strong> (<em>str</em>) – The name of the column in <cite>gauges</cite> that contains the unique identifier for each gauge.</p></li>
<li><p><strong>field_basin</strong> (<em>str</em>) – The name of the column in <cite>basins</cite> that contains the unique identifier for each basin.</p></li>
<li><p><strong>field_basin_down</strong> (<em>str</em>) – The name of the column in <cite>basins</cite> that contains the unique identifier of the downstream basin.</p></li>
<li><p><strong>field_geometry</strong> (<em>str</em>) – The name of the geometry column. Default value = “geometry”</p></li>
<li><p><strong>dissolve</strong> (<em>bool</em>) – If True, dissolves the upstream basins into a single feature for each gauge. Default value = True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A GeoDataFrame with the upstream basins for each gauge, including the gauge identifier. Returns None if no gauges are found within any basin.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.get_upstream_features">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">get_upstream_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_id_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geometry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_starting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#get_upstream_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.get_upstream_features" title="Link to this definition">#</a></dt>
<dd><p>Retrieves all upstream features from a given starting point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>) – A DataFrame containing all features.</p></li>
<li><p><strong>field_id</strong> (<em>str</em>) – The name of the column containing the feature’s unique ID.</p></li>
<li><p><strong>field_id_down</strong> (<em>str</em>) – The name of the column containing the ID of the downstream feature.</p></li>
<li><p><strong>start_id</strong> (<em>int</em><em> or </em><em>str</em>) – The ID of the starting feature.</p></li>
<li><p><strong>include_start</strong> (<em>bool</em>) – [optional] Whether to include the starting feature in the output. Default value = True</p></li>
<li><p><strong>field_geometry</strong> (<em>str</em>) – [optional] The name of the column containing the geometry of the feature. Default value = “geometry”</p></li>
<li><p><strong>is_starting</strong> (<em>bool</em>) – [optional] A flag to indicate if it’s the initial call of the function. Default value = True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with the upstream features, or None if no upstream features are found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">geopandas.GeoDataFrame</span></code>  or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.get_array_bbox">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">get_array_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#get_array_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.get_array_bbox" title="Link to this definition">#</a></dt>
<dd><p>Finds the bounding box for the content (1s) in a 2D pseudo-boolean array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D numpy array with values 1 (content) and 0 (background)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with keys “i_min”, “i_max”, “j_min”, “j_max” representing the row and column bounds of the content</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.convert">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.convert" title="Link to this definition">#</a></dt>
<dd><p>Convert values in array from old to new values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Numpy array to convert values</p></li>
<li><p><strong>old_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – iterable of old values</p></li>
<li><p><strong>new_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – iterable of new values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.classify">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upvalues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.classify" title="Link to this definition">#</a></dt>
<dd><p>Classify array based on list of upper values and list of classes values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – numpy array to classify</p></li>
<li><p><strong>upvalues</strong> – 1d numpy array of upper values</p></li>
<li><p><strong>classes</strong> – 1d array of classes values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy array reclassified</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.normalize">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.normalize" title="Link to this definition">#</a></dt>
<dd><p>Normalize array between min and max values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Input array or float</p></li>
<li><p><strong>min_value</strong> (<em>float</em>) – minimum vale</p></li>
<li><p><strong>max_value</strong> (<em>float</em>) – maximum value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output array or float</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.fuzzify">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">fuzzify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#fuzzify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.fuzzify" title="Link to this definition">#</a></dt>
<dd><p>Fuzzify array between min and max values with linear membership function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Input array or float</p></li>
<li><p><strong>min_value</strong> (<em>float</em>) – minimum value threshold</p></li>
<li><p><strong>max_value</strong> (<em>float</em>) – maximum value threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output array or float</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.prune">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#prune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.prune" title="Link to this definition">#</a></dt>
<dd><p>Inclusive prune values in array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Numpy array to prune values</p></li>
<li><p><strong>min_value</strong> (<em>float</em>) – minimum values to prune (inclusive)</p></li>
<li><p><strong>max_value</strong> (<em>float</em>) – maximum values to prude (inclusive)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pruned array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.upscale">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">upscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#upscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.upscale" title="Link to this definition">#</a></dt>
<dd><p>Upscales an array using a specified mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The input array to be upscaled.</p></li>
<li><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – [optional] An array of weights to apply. Default value = None</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The mode to use for upscaling, either “mean” or “sum”. Default value = “mean”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The upscaled value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.downscale_linear">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">downscale_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#downscale_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.downscale_linear" title="Link to this definition">#</a></dt>
<dd><p>Applies linear downscaling to a covariance array based on a scalar value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scalar</strong> (<em>float</em>) – The scalar value used for downscaling.</p></li>
<li><p><strong>array_covar</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The covariance array to be downscaled.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The aggregation mode to use, “mean” or “sum”. Default value = “mean”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The linearly downscaled array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.downscale_variance">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">downscale_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mirror</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simple'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#downscale_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.downscale_variance" title="Link to this definition">#</a></dt>
<dd><p>Applies a downscaling operation to a mean array based on a covariance array and a scaling factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The input mean array.</p></li>
<li><p><strong>array_covar</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The covariance array used for downscaling.</p></li>
<li><p><strong>scale_factor</strong> (<em>float</em>) – The factor by which to downscale.</p></li>
<li><p><strong>mirror</strong> (<em>bool</em>) – Whether to mirror the downscaling effect. Default value = False</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The post-processing mode to apply. Can be “simple”, “prune”, “truncate”, or “compensate”. Default value = “simple”</p></li>
<li><p><strong>max_value</strong> (<em>float</em>) – [optional] The maximum value for pruning or truncation.</p></li>
<li><p><strong>min_value</strong> (<em>float</em>) – [optional] The minimum value for pruning or truncation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The downscaled array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.downscaling_mask">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">downscaling_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_covar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#downscaling_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.downscaling_mask" title="Link to this definition">#</a></dt>
<dd><p>Compute a downscaling mask by using a covariate array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array_covar</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Numpy array of a covariate</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – scale factor (expected to be positive)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>downscaling mask array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.soils">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">soils</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hand_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#soils"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.soils" title="Link to this definition">#</a></dt>
<dd><p>Calculates a basic soil classification grid based on slope and HAND (Height Above Nearest Drainage) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The slope array.</p></li>
<li><p><strong>hand</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The HAND (Height Above Nearest Drainage) array.</p></li>
<li><p><strong>slope_threshold</strong> (<em>int</em>) – The slope threshold for identifying neosols. Default value = 25</p></li>
<li><p><strong>hand_threshold</strong> (<em>int</em>) – The HAND threshold for identifying alluvial soils. Default value = 5</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A grid representing soil types (1: default, 2: neosols, 3: alluvial).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.slope">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#slope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.slope" title="Link to this definition">#</a></dt>
<dd><p>Calculate slope using gradient-based algorithms on a 2D numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dem</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D numpy array representing the Digital Elevation Model (<code class="docutils literal notranslate"><span class="pre">DEM</span></code>).</p></li>
<li><p><strong>cellsize</strong> (<em>float</em>) – The size of a grid cell in the <code class="docutils literal notranslate"><span class="pre">DEM</span></code> (both in x and y directions).</p></li>
<li><p><strong>degree</strong> (<em>bool</em>) – If True (default), the output slope values are in degrees. If False, output units are in radians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy array representing the slope values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.buffer">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grd_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.buffer" title="Link to this definition">#</a></dt>
<dd><p>Calculate a buffer mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grd_input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Pseudo-boolean 2D numpy array where pixels with value 1 represent the foreground.</p></li>
<li><p><strong>n_radius</strong> (<em>int</em>) – number of pixels for buffer (inclusive)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pseudo-boolean 2D numpy array representing buffer area.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.euclidean_distance">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">euclidean_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grd_input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#euclidean_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.euclidean_distance" title="Link to this definition">#</a></dt>
<dd><p>Calculate the Euclidean distance from pixels with value 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grd_input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Pseudo-boolean 2D numpy array where pixels with value 1 represent the foreground.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array representing the Euclidean distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
<p><strong>Note</strong></p>
<ul class="simple">
<li><p>The function uses the <cite>distance_transform_edt</cite> from <cite>scipy.ndimage</cite> to compute the Euclidean distance.</p></li>
<li><p>The inputs array is treated as a binary mask, and the distance is calculated from foreground pixels (value 1).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.twi">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">twi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flowacc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#twi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.twi" title="Link to this definition">#</a></dt>
<dd><p>Calculate the Topographic Wetness Index <code class="docutils literal notranslate"><span class="pre">TWI</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D numpy array representing the slope in degrees.</p></li>
<li><p><strong>flowacc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2D numpy array representing the flow accumulation.</p></li>
<li><p><strong>cellsize</strong> (<em>float</em>) – The size of a grid cell (delta x = delta y).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array representing the Topographic Wetness Index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
<p><strong>Note</strong></p>
<ul class="simple">
<li><p>The function uses the formula: TWI = ln( A / hc_colors tan(S)), where A is flow accumulation, hc_colors is the cell resolution and S is slope in radians.</p></li>
<li><p>The inputs arrays <cite>slope</cite> and <cite>flowacc</cite> should have the same dimensions.</p></li>
<li><p>The formula includes a small value (0.01) to prevent issues with tangent calculations for non-NaN values.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.shalstab_wetness">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">shalstab_wetness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flowacc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soil_phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soil_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soil_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soil_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kPa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#shalstab_wetness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.shalstab_wetness" title="Link to this definition">#</a></dt>
<dd><p>Calculate the SHALSTAB wetness model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flowacc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – flow accumulation map (square meters)</p></li>
<li><p><strong>slope</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – slope map (degrees or radians)</p></li>
<li><p><strong>cellsize</strong> (<em>float</em>) – grid cell size (meters)</p></li>
<li><p><strong>soil_phi</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – soil angle of internal friction (degrees or radians)</p></li>
<li><p><strong>soil_z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – soil depth (meters)</p></li>
<li><p><strong>soil_c</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – soil cohesion (Pa or N/m0² or kg/ms²)</p></li>
<li><p><strong>soil_p</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – soil density (kg/m0³)</p></li>
<li><p><strong>water_p</strong> (<em>float</em>) – water density (kg/m0³)</p></li>
<li><p><strong>g</strong> (<em>float</em>) – gravity acceleration (m0 / s²)</p></li>
<li><p><strong>degree</strong> (<em>bool</em>) – flag to note if slope and soil_phi are in degrees</p></li>
<li><p><strong>kPa</strong> (<em>bool</em>) – flag to note if soil_c in kPa</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>map of q/T ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.usle_l">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">usle_l</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#usle_l"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.usle_l" title="Link to this definition">#</a></dt>
<dd><p>Wischmeier &amp; Smith (1978) L factor</p>
<p>L = (x / 22.13) ^ m0</p>
<p>where:</p>
<p>m0 = 0.2 when sinθ &lt; 0.01;
m0 = 0.3 when 0.01 ≤ sinθ ≤ 0.03;
m0 = 0.4 when 0.03 &lt; sinθ &lt; 0.05;
m0 = 0.5 when sinθ ≥ 0.05</p>
<p>x is the plot lenght taken as 1.4142 * cellsize  (diagonal length of cell)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – slope in degrees of terrain 2d array</p></li>
<li><p><strong>cellsize</strong> (<em>float</em>) – cell size in meters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Wischmeier &amp; Smith (1978) L factor 2d array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.usle_s">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">usle_s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#usle_s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.usle_s" title="Link to this definition">#</a></dt>
<dd><p>Calculates the USLE S-factor (slope steepness factor) based on the Wischmeier &amp; Smith (1978) equation.</p>
<p>S = 65.41(sinθ)^2 + 4.56sinθ + 0.065</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>slope</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Slope in degrees of terrain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The USLE S-factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.usle_m_a">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">usle_m_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#usle_m_a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.usle_m_a" title="Link to this definition">#</a></dt>
<dd><p>USLE-M Annual Soil Loss (Kinnell &amp; Risse, 1998)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Annual runoff in mm/year.</p></li>
<li><p><strong>prec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – Annual precipitation in mm/year.</p></li>
<li><p><strong>r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – Rain erosivity in MJ mm h-1 ha-1 year-1.</p></li>
<li><p><strong>k</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – Erodibility K factor in ton h MJ-1 mm-1.</p></li>
<li><p><strong>l</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – USLE/RUSLE L factor.</p></li>
<li><p><strong>s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – USLE/RUSLE S factor.</p></li>
<li><p><strong>c</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – C_UM factor.</p></li>
<li><p><strong>p</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or float) – USLE/RUSLE P factor.</p></li>
<li><p><strong>cellsize</strong> (<em>float</em>) – Grid cell size in meters. Default value = 30</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Annual Soil Loss in ton/year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.rivers_wedge">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">rivers_wedge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grd_rivers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wedge_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wedge_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#rivers_wedge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.rivers_wedge" title="Link to this definition">#</a></dt>
<dd><p>Generate a wedge-like trench along the river lines.</p>
<p>Notes:</p>
<ul class="simple">
<li><p>The function generates a wedge-like trench along the river lines based on distance transform.</p></li>
<li><p>The inputs array <cite>grd_rivers</cite> should be a pseudo-boolean grid where rivers are represented as 1 and others as 0.</p></li>
<li><p>The width <cite>w</cite> controls the width of the trench, and <cite>h</cite> controls its height.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grd_rivers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Pseudo-boolean grid indicating the presence of rivers.</p></li>
<li><p><strong>wedge_width</strong> (<em>int</em>) – Width (single-sided) in pixels. Default is 3.</p></li>
<li><p><strong>wedge_depth</strong> (<em>float</em>) – Depth in meters. Default is 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Grid of the wedge (positive).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.carve_dem">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">carve_dem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grd_dem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grd_rivers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wedge_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wedge_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#carve_dem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.carve_dem" title="Link to this definition">#</a></dt>
<dd><p>Burn a <code class="docutils literal notranslate"><span class="pre">DEM</span></code> map with river lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grd_dem</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – <code class="docutils literal notranslate"><span class="pre">DEM</span></code> map.</p></li>
<li><p><strong>grd_rivers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – River map (pseudo-boolean).</p></li>
<li><p><strong>wedge_width</strong> (<em>int</em>) – Width parameter in cells. Default is 3.</p></li>
<li><p><strong>wedge_depth</strong> (<em>float</em>) – Depth parameter. Default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Burned <code class="docutils literal notranslate"><span class="pre">DEM</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
<p><strong>Note</strong></p>
<ul class="simple">
<li><p>The function burns a <code class="docutils literal notranslate"><span class="pre">DEM</span></code> map with river lines, creating a wedge-like trench along the rivers.</p></li>
<li><p>The inputs array <cite>grd_rivers</cite> should be a pseudo-boolean grid where rivers are represented as 1 and others as 0.</p></li>
<li><p>The width <cite>w</cite> controls the width of the trench, and <cite>h</cite> controls its height.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.downstream_coordinates">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">downstream_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldd_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wbt'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#downstream_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.downstream_coordinates" title="Link to this definition">#</a></dt>
<dd><p>Compute i and j downstream cell coordinates based on cell flow direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_dir</strong> (<em>int</em>) – Flow direction code.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – i (row) array index.</p></li>
<li><p><strong>j</strong> (<em>int</em>) – j (column) array index.</p></li>
<li><p><strong>ldd_convention</strong> (<em>str</em>) – String of flow direction convention. Options: <code class="docutils literal notranslate"><span class="pre">wbt</span></code>, <code class="docutils literal notranslate"><span class="pre">d8</span></code>, <code class="docutils literal notranslate"><span class="pre">pcraster</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">wbt</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of downstream i, j, and distance factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>Assumes a specific flow direction convention (<code class="docutils literal notranslate"><span class="pre">wbt</span></code>, <code class="docutils literal notranslate"><span class="pre">d8</span></code>, <code class="docutils literal notranslate"><span class="pre">pcraster</span></code>).</p></li>
<li><p>The output dictionary contains keys ‘i’, ‘j’, and ‘distance’.</p></li>
<li><p>The ‘i’ and ‘j’ values represent downstream cell coordinates.</p></li>
<li><p>The ‘distance’ value is the Euclidean distance to the downstream cell.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">LDD</span></code> conventions:</p>
<p><code class="docutils literal notranslate"><span class="pre">wbt</span></code> convention derived from the WhiteboxTool.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id1" style="width: 30%">
<caption><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">wbt</span></code> convention</span><a class="headerlink" href="#id1" title="Link to this table">#</a></caption>
<tbody>
<tr class="row-odd"><td><p>64</p></td>
<td><p>128</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>32</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>8</p></td>
<td><p>4</p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="docutils literal notranslate"><span class="pre">d8</span></code> convention derived from the SAGA tool.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id2" style="width: 30%">
<caption><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">d8</span></code> convention</span><a class="headerlink" href="#id2" title="Link to this table">#</a></caption>
<tbody>
<tr class="row-odd"><td><p>6</p></td>
<td><p>7</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pcraster</span></code> convention derived from the PC-Raster tool.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id3" style="width: 30%">
<caption><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">pcraster</span></code> convention</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<tbody>
<tr class="row-odd"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>5</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>8</p></td>
<td><p>9</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Examples</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">downstream_coordinates</span><span class="p">(</span><span class="n">n_dir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ldd_convention</span><span class="o">=</span><span class="s1">&#39;pcraster&#39;</span><span class="p">)</span>
<span class="go">{&#39;i&#39;: 4, &#39;j&#39;: 3, &#39;distance&#39;: np.float64(1.4142135623730951)}</span>
</pre></div>
</div>
<p>Change convention:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">downstream_coordinates</span><span class="p">(</span><span class="n">n_dir</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ldd_convention</span><span class="o">=</span><span class="s1">&#39;d8&#39;</span><span class="p">)</span>
<span class="go">{&#39;i&#39;: 10, &#39;j&#39;: 14, &#39;distance&#39;: np.float64(1.0)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plans.geo.distance_to_outlet">
<span class="sig-prename descclassname"><span class="pre">plans.geo.</span></span><span class="sig-name descname"><span class="pre">distance_to_outlet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grd_ldd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldd_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wbt'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plans/geo.html#distance_to_outlet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plans.geo.distance_to_outlet" title="Link to this definition">#</a></dt>
<dd><p>Compute the distance to outlet <code class="docutils literal notranslate"><span class="pre">DTO</span></code> raster of a given basin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grd_ldd</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 2d numpy array of flow direction LDD</p></li>
<li><p><strong>n_res</strong> (<em>int</em>) – Resolution factor for the output distance raster. Default is 30.</p></li>
<li><p><strong>ldd_convention</strong> (<em>str</em>) – String of flow direction convention. Options: <code class="docutils literal notranslate"><span class="pre">wbt</span></code>, <code class="docutils literal notranslate"><span class="pre">d8</span></code>, <code class="docutils literal notranslate"><span class="pre">pcraster</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">wbt</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2d numpy array distance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plans.analyst.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">plans.analyst</p>
      </div>
    </a>
    <a class="right-next"
       href="plans.project.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">plans.project</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.extents_to_wkt_box"><code class="docutils literal notranslate"><span class="pre">extents_to_wkt_box()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.get_basins_by_gauges"><code class="docutils literal notranslate"><span class="pre">get_basins_by_gauges()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.get_upstream_features"><code class="docutils literal notranslate"><span class="pre">get_upstream_features()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.get_array_bbox"><code class="docutils literal notranslate"><span class="pre">get_array_bbox()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.convert"><code class="docutils literal notranslate"><span class="pre">convert()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.classify"><code class="docutils literal notranslate"><span class="pre">classify()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.normalize"><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.fuzzify"><code class="docutils literal notranslate"><span class="pre">fuzzify()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.prune"><code class="docutils literal notranslate"><span class="pre">prune()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.upscale"><code class="docutils literal notranslate"><span class="pre">upscale()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.downscale_linear"><code class="docutils literal notranslate"><span class="pre">downscale_linear()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.downscale_variance"><code class="docutils literal notranslate"><span class="pre">downscale_variance()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.downscaling_mask"><code class="docutils literal notranslate"><span class="pre">downscaling_mask()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.soils"><code class="docutils literal notranslate"><span class="pre">soils()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.slope"><code class="docutils literal notranslate"><span class="pre">slope()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.buffer"><code class="docutils literal notranslate"><span class="pre">buffer()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.euclidean_distance"><code class="docutils literal notranslate"><span class="pre">euclidean_distance()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.twi"><code class="docutils literal notranslate"><span class="pre">twi()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.shalstab_wetness"><code class="docutils literal notranslate"><span class="pre">shalstab_wetness()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.usle_l"><code class="docutils literal notranslate"><span class="pre">usle_l()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.usle_s"><code class="docutils literal notranslate"><span class="pre">usle_s()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.usle_m_a"><code class="docutils literal notranslate"><span class="pre">usle_m_a()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.rivers_wedge"><code class="docutils literal notranslate"><span class="pre">rivers_wedge()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.carve_dem"><code class="docutils literal notranslate"><span class="pre">carve_dem()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.downstream_coordinates"><code class="docutils literal notranslate"><span class="pre">downstream_coordinates()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plans.geo.distance_to_outlet"><code class="docutils literal notranslate"><span class="pre">distance_to_outlet()</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/plans.geo.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Iporã Possantti.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>