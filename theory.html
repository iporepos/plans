
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Theoretical Reference &#8212; plans 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'theory';</script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="System Index" href="system.html" />
    <link rel="prev" title="About" href="about.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
    
    <img src="https://github.com/iporepos/plans-assets/blob/main/docs/figs/logo.jpg?raw=true" class="logo__image only-light" alt=""/>
    <img src="https://github.com/iporepos/plans-assets/blob/main/docs/figs/logo.jpg?raw=true" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">plans</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Home
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="userguide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="development.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/iporepos/plans" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Home
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="userguide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="development.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/iporepos/plans" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Theoretical Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="system.html">System Index</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases.html">Study Cases</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="about.html" class="nav-link">About</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Theoretical Reference</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Documentation website under active development. This is not a stable release.</p>
</div>
<section id="theoretical-reference">
<span id="theory"></span><h1>Theoretical Reference<a class="headerlink" href="#theoretical-reference" title="Link to this heading">#</a></h1>
<section id="introduction">
<span id="theory-introduction"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This page provides a basic theoretical background and some technical details
for understanding how the <code class="docutils literal notranslate"><span class="pre">plans</span></code> model work.</p>
<div class="seealso admonition">
<p class="admonition-title">System components index</p>
<p>Check out the full reference for variables and parameters at the
<a class="reference internal" href="system.html#system-index"><span class="std std-ref">System Index</span></a> page.</p>
</div>
</section>
<section id="system-models">
<span id="theory-systems"></span><h2>System Models<a class="headerlink" href="#system-models" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">plans</span></code> model is based on a <a class="reference external" href="https://en.wikipedia.org/wiki/System_dynamics">System Dynamics</a> approach, representing the
hillslope system as a column of interconnected storages — like a series
of “water buckets” — that fill, spill, drain and dry over time.</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/System_dynamics">System Dynamics</a> approach is a modeling paradigm used to represent complex systems
through a set of interconnected components. Under this paradigm, a model is
built as a network of <strong>storages</strong> and <strong>flows</strong> that move between them.</p>
<p>Other model paradigms include <strong>data-driven models</strong>, where empirical and
statistical approaches are used, and <strong>distributed models</strong> (also known as
physically-based models), where flows are described by the calculation of
the water velocity vector field.</p>
<section id="system-dynamics-in-hydrology">
<span id="theory-system-hydrology"></span><h3>System Dynamics in Hydrology<a class="headerlink" href="#system-dynamics-in-hydrology" title="Link to this heading">#</a></h3>
<p>System Dynamics models has a long history in Hydrology. The earliest
hydrological models (the Stanford Model) were based on this paradigm because
it is intuitive, simple to understand and easy to develop. In short, the
catchment is represented as web of storages (like water buckets) connected by flows.</p>
<p>The <strong>parameters</strong> of the model define the size of the storages, regulate the
flows, determine the feedback mechanisms that govern system behavior.</p>
<p>Initial and boundary conditions also must be defined to start the simulation.
<strong>Initial conditions</strong> usually are the storage levels at the first time step.
<strong>Boundary conditions</strong> are a set of information that shapes the system, like
the structure of terrain topography and channel network.</p>
</section>
<section id="lumped-and-semi-distributed-models">
<span id="theory-system-models"></span><h3>Lumped and semi-distributed models<a class="headerlink" href="#lumped-and-semi-distributed-models" title="Link to this heading">#</a></h3>
<p>System Dynamics models in Hydrology can be fully <strong>lumped</strong>, where the
entire catchment or hillslope is represented by a single system of storages,
or <strong>semi-distributed</strong>, where the catchment is divided into an array of
cells. This cells can be spatially arranged in a regular or irregular grid or mesh.</p>
<p>In the case of semi-distributed models, each cell or unit is simulated
just like a tiny lumped model, also known as Hydrological Response Units <code class="docutils literal notranslate"><span class="pre">HRU</span></code>.
This is a key difference from truly distributed models, which use gridded
spatial representations of the velocity vector field to calculate flows.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">plans</span></code> model falls into the category of semi-distributed models.</p>
</section>
<section id="simulation-approaches">
<span id="theory-simulation-approaches"></span><h3>Simulation approaches<a class="headerlink" href="#simulation-approaches" title="Link to this heading">#</a></h3>
<p>In semi-distributed models, Hydrological response units <code class="docutils literal notranslate"><span class="pre">HRU</span></code> can be
simulated in two main ways: <strong>grid-to-grid simulation</strong> and <strong>histogram simulation</strong>.
Each approach has distinct advantages and limitations, depending on the
scale of the study area and the computational resources available.</p>
<section id="grid-to-grid-simulation">
<span id="theory-g2g"></span><h4>Grid-To-Grid simulation<a class="headerlink" href="#grid-to-grid-simulation" title="Link to this heading">#</a></h4>
<p>In grid-to-grid simulation <code class="docutils literal notranslate"><span class="pre">G2G</span></code>, each map cell (or pixel) is treated as an
unique <code class="docutils literal notranslate"><span class="pre">HRU</span></code>. This approach is most suitable when parameters are expressed
as continuous spatial variables (e.g., canopy cover, soil storage capacity, etc).</p>
<p><em>Advantages</em>:
- Directly represents spatial heterogeneity at pixel resolution.
- Results are already mapped at the same scale as the input data, requiring no additional downscaling.</p>
<p><em>Disadvantages</em>:
- Memory- and computation-intensive, especially for large basins.
- Simulation may become impractical if the study area contains millions of cells.</p>
</section>
<section id="histogram-simulation">
<span id="theory-hst"></span><h4>Histogram Simulation<a class="headerlink" href="#histogram-simulation" title="Link to this heading">#</a></h4>
<p>In histogram simulation <code class="docutils literal notranslate"><span class="pre">HST</span></code>, the <code class="docutils literal notranslate"><span class="pre">HRU</span></code> units are larger patches that
share common parameter values. For example, canopy parameters may be
averaged for all cells within a given land-use class.</p>
<p>The area fraction of each <code class="docutils literal notranslate"><span class="pre">HRU</span></code> type is then represented in a histogram,
which is used to upscale simulated values.</p>
<p><em>Advantages</em>:
- Highly efficient in terms of memory and computational cost.
- Suitable for large study areas where grid-to-grid simulation is infeasible.
- Suitable for calibration or monte carlo analysis where many simulations are needed.</p>
<p><em>Disadvantages</em>:
- Simulation occurs at an intermediate scale, requiring an additional step to downscale or reproject results back onto maps.
- Some spatial detail is lost due to parameter aggregation.
- Mapping outputs back to raster resolution requires extra processing.</p>
</section>
</section>
<section id="water-balance">
<span id="theory-water-balance"></span><h3>Water balance<a class="headerlink" href="#water-balance" title="Link to this heading">#</a></h3>
<p>In System Dynamics models of Hydrology, the key process of simulation is
the water balance. Each storage is evaluated in terms of its net balance:
all inflows are added to the current water level and all outflows are
subtracted. This evaluation is performed at every time step of the simulation,
so that the state of each storage is updated step by step.</p>
<p>This process can be expressed as a numerical equation where the storage
level at the next time step is equal to the previous storage level plus
the sum of all inflows minus the sum of all outflows.</p>
<div class="math notranslate nohighlight" id="equation-eq-water-balance">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-water-balance" title="Link to this equation">#</a></span>\[S_{t+1} = S_t + \sum \text{inflows} - \sum \text{outflows}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(S\)</span> is the storage level, <span class="math notranslate nohighlight">\(t\)</span> is the current time step,
<span class="math notranslate nohighlight">\(t+1\)</span> is the next time step, and the summations represent the
total inflows and outflows during the interval.</p>
<p>In Hydrology, a typical soil water (<span class="math notranslate nohighlight">\(S\)</span>) balance at the catchment
scale would include precipitation (<span class="math notranslate nohighlight">\(P\)</span>) as the main inflow,
and evapotranspiration (<span class="math notranslate nohighlight">\(E\)</span>) and streamflow (<span class="math notranslate nohighlight">\(Q\)</span>)
as the main outflows:</p>
<div class="math notranslate nohighlight" id="equation-eq-catchment-balance">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-catchment-balance" title="Link to this equation">#</a></span>\[S_{t+1} = S_t + P - (E + Q)\]</div>
<p>This example represents the long-term water balance for an entire catchment,
while each individual storage or sub-component has its own water balance
computed within a model.</p>
</section>
</section>
<section id="hydrology">
<span id="theory-hydrology"></span><h2>Hydrology<a class="headerlink" href="#hydrology" title="Link to this heading">#</a></h2>
<section id="linear-storage">
<span id="theory-linear-storage"></span><h3>Linear Storage<a class="headerlink" href="#linear-storage" title="Link to this heading">#</a></h3>
<p>The Linear Storage is a fundamental concept in System Dynamics and in Hydrology.
Early works, such as Horton (1933), proposed that soil and aquifers behaves like
a linear reservoir: it drains in proportion to the current storage level.</p>
<p>A simple way to visualize this is to imagine a water bucket with a small and porous
hole at the bottom. The bucket drains continuously, and the discharge rate
is proportional to the water level inside. As the storage empties, the
discharge gradually decreases, eventually approaching zero as time tends
to infinity.</p>
<p>This behavior can be described by a simple differential equation, where
the outflow is proportional to the storage. The parameter <span class="math notranslate nohighlight">\(k\)</span> is
known as the <em>residence time</em> and controls how quickly or slowly the
storage drains.</p>
<div class="math notranslate nohighlight" id="equation-eq-linear-storage">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-linear-storage" title="Link to this equation">#</a></span>\[Q(t) = \frac{1}{k} \cdot S(t)\]</div>
<p>In this equation, <span class="math notranslate nohighlight">\(Q(t)\)</span> is the outflow at time <span class="math notranslate nohighlight">\(t\)</span>,
<span class="math notranslate nohighlight">\(S(t)\)</span> is the current storage, and <span class="math notranslate nohighlight">\(k\)</span> is the residence time.
A small value of <span class="math notranslate nohighlight">\(k\)</span> results in faster drainage, while a larger
<span class="math notranslate nohighlight">\(k\)</span> leads to slower drainage. Although this equation can be solved
analytically for a single storage, in practice it is often embedded within
a numerical scheme, like the Euler Method, that accounts for multiple
inflows, outflows, and other interacting storages.</p>
</section>
<section id="recession-curves">
<span id="theory-recession-curves"></span><h3>Recession curves<a class="headerlink" href="#recession-curves" title="Link to this heading">#</a></h3>
<p>When solved analytically for an isolated storage with no additional inflows,
the solution yields an exponential decay, or <strong>recession curve</strong>:</p>
<div class="math notranslate nohighlight" id="equation-eq-recession-curve">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-recession-curve" title="Link to this equation">#</a></span>\[Q(t) = Q_0 \cdot e^{-t/k}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(Q_0\)</span> is the initial discharge at the beginning of the recession.
This equation describes how discharge decreases exponentially over time,
converging asymptotically toward zero.</p>
<p>Horton (1933) noted that this behavior closely matches the observed recession
curves of rivers during periods of no rainfall and negligible evapotranspiration.
These curves provide valuable information about the catchment’s storage
properties, allowing estimates of parameters such as <span class="math notranslate nohighlight">\(Q_0\)</span> and the
effective storage capacity of the catchment.</p>
<p>In practice, these are effective values representing the average conditions
of the soils and aquifers that contribute to baseflow at the gauging section.</p>
</section>
<section id="subsurface-flows">
<span id="theory-subsurface-flows"></span><h3>Subsurface flows<a class="headerlink" href="#subsurface-flows" title="Link to this heading">#</a></h3>
<p>Although linear storage provides a good first approximation for groundwater
drainage, early studies showed that it does not represent all forms of flow
from soils to streams. In many forested catchments, a significant portion
of stream response can be attributed to fast <strong>subsurface flow</strong> through macropores
and highly conductive soil layers.</p>
<p>These macropores, often formed by root channels, decayed organic material,
or soil cracks, create preferential flow paths that transmit water rapidly downslope.
As a result, headwater streams may rise quickly after rainfall events even when there
is no direct overland flow and no significant recharge to deep groundwater.</p>
<p>This process is particularly important in forest hydrology and in hillslopes
with well-developed organic layers, where macropore flow can dominate the
hydrological response.</p>
</section>
<section id="theory-overland-flow">
<span id="id1"></span><h3>Overland flow<a class="headerlink" href="#theory-overland-flow" title="Link to this heading">#</a></h3>
<p><strong>Overland flow</strong>, also known as <strong>runoff</strong>, occurs when rain flow fills
the <strong>surface storage</strong>, causing a <strong>spill flow</strong> pulse by the activation
small channels that convey water downhill to the main stream network.</p>
<p>There are two main <strong>mechanisms</strong> for overland flow generation:</p>
<section id="infiltration-excess">
<span id="theory-infiltration-excess"></span><h4>Infiltration-excess<a class="headerlink" href="#infiltration-excess" title="Link to this heading">#</a></h4>
<p>This happens when rain flow is so intense that infiltration flow is exceeded.
Common during heavy storms and where the soil surface presents a high residence
time (like compacted soils).</p>
</section>
<section id="saturation-excess">
<span id="theory-saturation-excess"></span><h4>Saturation-excess<a class="headerlink" href="#saturation-excess" title="Link to this heading">#</a></h4>
<p>This occurs when rain reaches areas where soil is fully saturated and there
is zero potential for infiltration. Common in all events where rain reaches
a saturated soil surface.</p>
</section>
</section>
<section id="variable-source-area">
<span id="theory-variable-source-area"></span><h3>Variable source area<a class="headerlink" href="#variable-source-area" title="Link to this heading">#</a></h3>
<p>The <strong>variable source area</strong> concept explains the spatial and temporal dynamics of
saturation-excess overland flow.</p>
<p>Saturated areas in the catchment, also known as <strong>riparian wetlands</strong>,
expand and contract depending on the soil water level. During wet periods,
saturated areas extend from valleys toward uphill regions, while during dry
periods they shrink.</p>
<p>This dynamic behavior creates a non-linear relationship between precipitation
and overland flow, where the same rainfall can generate very different amounts of
runoff depending on the antecedent wetness of the catchment.</p>
</section>
<section id="connectivity">
<span id="theory-connectivity"></span><h3>Connectivity<a class="headerlink" href="#connectivity" title="Link to this heading">#</a></h3>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla mollis tincidunt erat eget iaculis. Mauris gravida ex quam, in porttitor lacus lobortis vitae. In a lacinia nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi et tempor sem. Nullam quam dolor, venenatis eget magna ut, accumsan mollis erat.</p>
<div class="math notranslate nohighlight" id="equation-eq-connectivity">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-connectivity" title="Link to this equation">#</a></span>\[\begin{split}Q_a =
\begin{cases}
0 &amp; \text{if } \quad S \leq s_a \\
\Lambda \cdot (S - s_a) &amp; \text{if } \quad S &gt; s_a
\end{cases}\end{split}\]</div>
</section>
</section>
<section id="scaling">
<span id="theory-scaling"></span><h2>Scaling<a class="headerlink" href="#scaling" title="Link to this heading">#</a></h2>
<p>Scale issues are a common challenge in environmental modelling, spatial
analysis, and temporal analysis. The core difficulty lies in
<em>transferring information from one scale to another</em>, known as <strong>scaling</strong>.
This can occur in two main directions:</p>
<ul class="simple">
<li><p><strong>Upscaling</strong>: aggregating information from a finer scale to a coarser
scale (e.g., daily precipitation aggregated into monthly totals, or
county-level population data aggregated to the state level).</p></li>
<li><p><strong>Downscaling</strong>: distributing information from a coarser scale to a
finer scale (e.g., disaggregating monthly precipitation into daily
values, or allocating national population totals to local districts).</p></li>
</ul>
<p>In many cases, intermediate scales are also introduced, and each scale
is composed of discrete <em>units</em> that hold information.</p>
<section id="formal-notation">
<span id="theory-scaling-nomenclature"></span><h3>Formal Notation<a class="headerlink" href="#formal-notation" title="Link to this heading">#</a></h3>
<p><strong>Scale units in time or space</strong></p>
<p>Let the spatial or temporal region <span class="math notranslate nohighlight">\(R\)</span> be partitioned into
<span class="math notranslate nohighlight">\(N\)</span> units (e.g., patches in space or time intervals) with similar
attributes.</p>
<p><strong>Variable</strong> <span class="math notranslate nohighlight">\(V\)</span></p>
<p>Let <span class="math notranslate nohighlight">\(V_u\)</span> denote a scalar attribute associated with the unit of
index <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p><strong>Upper level</strong></p>
<p>At a coarser scale, upper-level unit is the region <span class="math notranslate nohighlight">\(R\)</span>
with extent <span class="math notranslate nohighlight">\(A\)</span> and attribute value <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p><strong>Lower level</strong> <span class="math notranslate nohighlight">\(i\)</span></p>
<p>At a finer scale, the upper-level unit is subdivided into
<span class="math notranslate nohighlight">\(N\)</span> lower-level units. Each lower-level unit, indexed by
<span class="math notranslate nohighlight">\(i \in \{1, 2, \ldots, N\}\)</span>, has extent
<span class="math notranslate nohighlight">\(A_{i}\)</span> and attribute value <span class="math notranslate nohighlight">\(V_{i}\)</span>.</p>
<p>This formalism provides a consistent framework for discussing scale
transformations, whether upscaling or downscaling, across both spatial
and temporal domains.</p>
</section>
<section id="upscaling">
<span id="theory-upscaling"></span><h3>Upscaling<a class="headerlink" href="#upscaling" title="Link to this heading">#</a></h3>
<p>Upscaling refers to transferring information from a finer scale
(lower-level units <span class="math notranslate nohighlight">\(V_{i}\)</span>) to a coarser scale
(upper-level unit <span class="math notranslate nohighlight">\(V\)</span>). Conceptually, information is <em>blended</em>
from the lower level to form a representative value at the higher level.</p>
<p>Two common cases of upscaling are:</p>
<ul class="simple">
<li><p><strong>Aggregation (sum)</strong> — typically used for <em>storage</em> variables or
cumulative quantities.</p></li>
<li><p><strong>Averaging (weighted mean)</strong> — typically used for <em>state</em> or
<em>flow</em> variables, where values are normalized by extent (area or
duration).</p></li>
</ul>
<p>The choice between aggregation and averaging depends on the type of
process or variable under consideration.</p>
<section id="aggregation">
<span id="theory-aggregation"></span><h4>Aggregation<a class="headerlink" href="#aggregation" title="Link to this heading">#</a></h4>
<p>In aggregation, the upscaled value is the sum of the lower-level values:</p>
<div class="math notranslate nohighlight" id="equation-eq-upscaling-agg">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-upscaling-agg" title="Link to this equation">#</a></span>\[ V = \sum_{i=1}^{N} V_{i}\]</div>
</section>
<section id="averaging">
<span id="theory-averaging"></span><h4>Averaging<a class="headerlink" href="#averaging" title="Link to this heading">#</a></h4>
<p>In averaging, the upscaled value is the weighted mean of the lower-level
values, with weights given by their extent:</p>
<div class="math notranslate nohighlight" id="equation-eq-upscaling-avg">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-upscaling-avg" title="Link to this equation">#</a></span>\[ V = \frac{ \sum_{i=1}^N V_{i} A_{i}}
             {\sum_{i=1}^N A_{i}}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V_{i}\)</span> is the attribute value of sub-unit <span class="math notranslate nohighlight">\(i\)</span> under the
upper-level unit,</p></li>
<li><p><span class="math notranslate nohighlight">\(A_{i}\)</span> is the extent (e.g., area, duration) of sub-unit
<span class="math notranslate nohighlight">\(i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> is the number of sub-units contained within the
upper-level unit</p></li>
</ul>
</section>
</section>
<section id="downscaling">
<span id="theory-downscaling"></span><h3>Downscaling<a class="headerlink" href="#downscaling" title="Link to this heading">#</a></h3>
<p>Downscaling is the process of disaggregating and distributing a variable
from upper-level units (<span class="math notranslate nohighlight">\(V\)</span>) to lower-level units
(<span class="math notranslate nohighlight">\(V_{i}\)</span>). Unlike upscaling, which aggregates information,
downscaling is more subtle because it <em>creates detail</em> based
on assumed premisses.</p>
<p>Downscaling relies on a <strong>distribution function</strong> <span class="math notranslate nohighlight">\(f\)</span>. This also
needs one or more <strong>covariate</strong> <span class="math notranslate nohighlight">\(W_{i}\)</span> that is known at the target
lower level.</p>
<p>Formally, for one covariate:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-func">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-downscaling-func" title="Link to this equation">#</a></span>\[ V_{i} = f(V, W_{i})\]</div>
<p>Several approaches can be applied, depending on the nature of the
variable and the covariates.</p>
<section id="linear-downscaling">
<span id="theory-downscaling-linear"></span><h4>Linear Downscaling<a class="headerlink" href="#linear-downscaling" title="Link to this heading">#</a></h4>
<p>Linear downscaling assumes a direct proportionality between the variable
of interest <span class="math notranslate nohighlight">\(V\)</span> and the covariate <span class="math notranslate nohighlight">\(W\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-linear1">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-downscaling-linear1" title="Link to this equation">#</a></span>\[ \frac{V_{i}}{V} = \frac{W_{i}}{W}\]</div>
<p>Rearranging yields:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-linear">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-downscaling-linear" title="Link to this equation">#</a></span>\[ V_{i} = W_{i} \cdot \frac{V}{W}\]</div>
</section>
<section id="variance-downscaling">
<span id="theory-downscaling-variance"></span><h4>Variance Downscaling<a class="headerlink" href="#variance-downscaling" title="Link to this heading">#</a></h4>
<p>Variance downscaling assumes that deviations of the covariate
<span class="math notranslate nohighlight">\(W_{i}\)</span> around its mean correspond proportionally to deviations
of the variable <span class="math notranslate nohighlight">\(V_{i}\)</span> around its mean:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-variance1">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-downscaling-variance1" title="Link to this equation">#</a></span>\[ V_{i} - \bar{V} \propto W_{i} - \bar{W}\]</div>
<p>Introducing a <strong>scaling factor</strong> <span class="math notranslate nohighlight">\(m\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-variance2">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-downscaling-variance2" title="Link to this equation">#</a></span>\[ V_{i} - \bar{V} = m \cdot (W_{i} - \bar{W})\]</div>
<p>Rearranging yields:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-variance">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-downscaling-variance" title="Link to this equation">#</a></span>\[ V_{i} = \bar{V} + m \cdot (W_{i} - \bar{W})\]</div>
<div class="caution admonition">
<p class="admonition-title">Caution with overflow error</p>
<p>Depending on the choice of scaling factor <span class="math notranslate nohighlight">\(m\)</span>, results for
<span class="math notranslate nohighlight">\(V_{i}\)</span> may produce unrealistic values, such as negative
quantities or extreme magnitudes (overflow error).</p>
</div>
</section>
<section id="reverse-variance-downscaling">
<span id="theory-downscaling-variance-reverse"></span><h4>Reverse Variance Downscaling<a class="headerlink" href="#reverse-variance-downscaling" title="Link to this heading">#</a></h4>
<p>Reverse proportionality of variance occurs when the covariate is a reversed
variable. This yields a a similar approach for downscaling:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-variance-rotated1">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-downscaling-variance-rotated1" title="Link to this equation">#</a></span>\[ V_{i} - \bar{V} = m \cdot (\bar{W} - W_{i})\]</div>
<p>Rearranging yields:</p>
<div class="math notranslate nohighlight" id="equation-eq-downscaling-variance-rotated">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-downscaling-variance-rotated" title="Link to this equation">#</a></span>\[ V_{i} = V - m \cdot (W_{i} - W)\]</div>
</section>
</section>
</section>
<section id="model-structure">
<span id="theory-model-structure"></span><h2>Model Structure<a class="headerlink" href="#model-structure" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">plans</span></code> model is based on a <a class="reference external" href="https://en.wikipedia.org/wiki/System_dynamics">System Dynamics</a> structure, representing the
hillslope system as <strong>columns</strong> of interconnected storages — like a collection
of water buckets — that fill, spill, drain and dry over time.</p>
<p>Each column is known as the <strong>hydrological response unit</strong> <code class="docutils literal notranslate"><span class="pre">HRU</span></code>. A
landscape spatial unit with a specific parameter set.</p>
<p>The model column begins with a canopy storage,
followed by a surface storage (which can include an organic soil layer
where present). Beneath it lies the mineral soil storage, divided into
an unsaturated zone (where water moves vertically through pores) and a
saturated phreatic zone (fully saturated, driving drainage and lateral
exchanges with neighboring cells).</p>
<figure class="align-center" id="id5">
<a class="reference external image-reference" href="https://github.com/iporepos/plans-assets/blob/main/docs/figs/model_structure.jpg?raw=true"><img alt="``plans`` model column structure" src="https://github.com/iporepos/plans-assets/blob/main/docs/figs/model_structure.jpg?raw=true" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">plans</span></code> model column structure</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="seealso admonition">
<p class="admonition-title">System components index</p>
<p>Check out the full reference for variables and parameters at the
<a class="reference internal" href="system.html#system-index"><span class="std std-ref">System Index</span></a> page.</p>
</div>
<section id="storage-phases">
<h3>Storage phases<a class="headerlink" href="#storage-phases" title="Link to this heading">#</a></h3>
<p>Each storage exchanges water through three main mechanisms: <strong>draining</strong>
(water leaks downward), <strong>spilling</strong> (water overflows to the next
component), and <strong>drying</strong> (water is lost through evaporation).
Together, these processes form a network of storages connected by flows,
with parameters regulating their behavior (e.g., residence time).</p>
<figure class="align-center" id="id6">
<a class="reference external image-reference" href="https://github.com/iporepos/plans-assets/blob/main/docs/figs/model_phases.jpg?raw=true"><img alt="model phases of filling, spilling, drying and draining" src="https://github.com/iporepos/plans-assets/blob/main/docs/figs/model_phases.jpg?raw=true" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-text">model phases of filling, spilling, drying and draining</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="model-equations">
<span id="theory-model-equations"></span><h2>Model Equations<a class="headerlink" href="#model-equations" title="Link to this heading">#</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla mollis tincidunt erat eget iaculis. Mauris gravida ex quam, in porttitor lacus lobortis vitae. In a lacinia nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi et tempor sem. Nullam quam dolor, venenatis eget magna ut, accumsan mollis erat.</p>
<div class="seealso admonition">
<p class="admonition-title">System components reference</p>
<p>Check out the full reference for variables and parameters at the <a class="reference internal" href="system.html#system-index"><span class="std std-ref">System Index</span></a> page.</p>
</div>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla mollis tincidunt erat eget iaculis. Mauris gravida ex quam, in porttitor lacus lobortis vitae. In a lacinia nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi et tempor sem. Nullam quam dolor, venenatis eget magna ut, accumsan mollis erat.</p>
<div class="math notranslate nohighlight" id="equation-eq-pythagoras">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-pythagoras" title="Link to this equation">#</a></span>\[a^2 + b^2 = c^2\]</div>
</section>
<section id="model-scaling">
<span id="theory-model-scaling"></span><h2>Model Scaling<a class="headerlink" href="#model-scaling" title="Link to this heading">#</a></h2>
<section id="theory-scaling-soil-moisture">
<span id="id2"></span><h3>Soil moisture<a class="headerlink" href="#theory-scaling-soil-moisture" title="Link to this heading">#</a></h3>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla mollis tincidunt erat eget iaculis. Mauris gravida ex quam, in porttitor lacus lobortis vitae. In a lacinia nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi et tempor sem. Nullam quam dolor, venenatis eget magna ut, accumsan mollis erat.</p>
</section>
<section id="parameters">
<span id="theory-scaling-parameters"></span><h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<section id="theory-upscaling-parameters">
<span id="id3"></span><h4>Upscaling<a class="headerlink" href="#theory-upscaling-parameters" title="Link to this heading">#</a></h4>
<p>Model parameters <span class="math notranslate nohighlight">\(V\)</span> of land use and soils are upscaled by
<a class="reference internal" href="#theory-averaging"><span class="std std-ref">Averaging</span></a>. Equation <a class="reference internal" href="#equation-eq-upscaling-avg">(7)</a> is
applied over the basin area in the map.</p>
<p>For example, if a basin contains multiple land-use or soil classes,
the <strong>effective parameter value</strong> for the entire basin is obtained as
the weighted average of each classes’s parameter value.
The weights in here correspond to the <strong>area</strong> of each class within the basin.</p>
<p>This formulation ensures that land use or soil classes with larger spatial
extent contribute more strongly to the effective, upscaled parameter value.</p>
</section>
<section id="theory-downscaling-parameters">
<span id="id4"></span><h4>Downscaling<a class="headerlink" href="#theory-downscaling-parameters" title="Link to this heading">#</a></h4>
<p>In contrast to upscaling, The effective basin-scale parameter value
<span class="math notranslate nohighlight">\(V\)</span> is known a priori from the model parameter table [todo link].
Once the value is known, the downscaling method applies
<a class="reference internal" href="#theory-downscaling-linear"><span class="std std-ref">Linear Downscaling</span></a>.</p>
<p>This means that Equation <a class="reference internal" href="#equation-eq-downscaling-linear">(10)</a> distributes the
basin-scale parameter value <span class="math notranslate nohighlight">\(V\)</span> back to the individual values <span class="math notranslate nohighlight">\(V_{i}\)</span> by
applying the provided <strong>downscaling weights</strong> <span class="math notranslate nohighlight">\(W_{i}\)</span> in the attribute table of
land use or soil classes [todo links].</p>
<div class="note admonition">
<p class="admonition-title">Using covariates as downscaling weights</p>
<p>Downscaling weights <span class="math notranslate nohighlight">\(W_{i}\)</span> can be defined with downscaling functions and
the use of <strong>covariates</strong>. For example, one might use a theory relating vegetation
indices (e.g., LAI or NDVI [todo link]) as proxies for the distribution of
land use parameters. The same logic applies to soils information.</p>
</div>
<p>.</p>
</section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla mollis tincidunt erat eget iaculis. Mauris gravida ex quam, in porttitor lacus lobortis vitae. In a lacinia nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi et tempor sem. Nullam quam dolor, venenatis eget magna ut, accumsan mollis erat.</p>
<div class="toctree-wrapper compound">
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="about.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">About</p>
      </div>
    </a>
    <a class="right-next"
       href="system.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">System Index</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-models">System Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#system-dynamics-in-hydrology">System Dynamics in Hydrology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lumped-and-semi-distributed-models">Lumped and semi-distributed models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-approaches">Simulation approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-to-grid-simulation">Grid-To-Grid simulation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-simulation">Histogram Simulation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#water-balance">Water balance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hydrology">Hydrology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-storage">Linear Storage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recession-curves">Recession curves</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subsurface-flows">Subsurface flows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-overland-flow">Overland flow</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#infiltration-excess">Infiltration-excess</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#saturation-excess">Saturation-excess</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-source-area">Variable source area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity">Connectivity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formal-notation">Formal Notation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upscaling">Upscaling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation">Aggregation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#averaging">Averaging</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downscaling">Downscaling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-downscaling">Linear Downscaling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-downscaling">Variance Downscaling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-variance-downscaling">Reverse Variance Downscaling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-structure">Model Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#storage-phases">Storage phases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-equations">Model Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-scaling">Model Scaling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-scaling-soil-moisture">Soil moisture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-upscaling-parameters">Upscaling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-downscaling-parameters">Downscaling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/theory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Iporã Possantti.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>